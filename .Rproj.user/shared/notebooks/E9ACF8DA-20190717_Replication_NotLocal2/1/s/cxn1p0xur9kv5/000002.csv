"0",""
"0","outcomes <- c(""RAPID"", ""TUUNGANE"", ""da109_not_verifiable"", ""qr026i_fund_misuse"","
"0","              ""qr2830_list_experiment"",""stdev_benefits"", ""Correct_B_projet"","
"0","              ""PART_A1"", ""N_INTERV"", ""MALE_DOM"", ""MFI_SELECTION"", ""MFI_COMPOSITION"", "
"0","              ""MFI_MECHANISMS"",""MFI_COMPLAINTS"", ""qr002CORRECT"", ""qi003_accept"", "
"0","              ""MFI_ACCOUNTING"")"
"0",""
"0","datasets <- list(cdcdata, cdcdata, vill, "
"0","                 ind,ind,vill,"
"0","                 ind, vill, vill,  vill,"
"0","                 vill, vill,  vill,ind,                         "
"0","                 ind, ind, vill)"
"0",""
"0",""
"0","sumStats <- mapply(function(y, d){"
"0","  "
"0","  IDVs <- cdcdata[,""IDV""]"
"0","  "
"0","  if(y == ""qr2830_list_experiment"" | y == ""Correct_B_projet""){"
"0","    "
"0","    # subset interactions"
"0","    if(y == ""qr2830_list_experiment"")   {i0 <- d$RB    == 0;i1 <- d$RB    == 1}"
"0","    if(y == ""Correct_B_projet"") {i0 <- d$CHIEF == 0; i1 <- d$CHIEF == 1}"
"0","    "
"0","    # compute subsetted villmeans "
"0","    villmean_0 <- aggregate(d[i0,c(""IDV"",y)], by= list(d$IDV[i0]), FUN=""mean"", na.rm=TRUE) %>%"
"0","      select(IDV, X_0 = y)"
"0","    villmean_1 <- aggregate(d[i1,c(""IDV"",y)], by= list(d$IDV[i1]), FUN=""mean"", na.rm=TRUE)%>%"
"0","      select(IDV, X_1 = y)"
"0","    "
"0","    # Clean up interactions -- Impute means where one side has data present"
"0","    villmean    <- merge(IDVs, villmean_0, by = ""IDV"", all.x = TRUE) %>%"
"0","      merge(villmean_1 ,by = ""IDV"", all.x = TRUE) %>%"
"0","      mutate(X_1 = ifelse(is.na(X_1)& !is.na(X_0), mean(X_1, na.rm = TRUE), X_1),"
"0","             X_0 = ifelse(!is.na(X_1)&!is.na(X_0), mean(X_0, na.rm = TRUE), X_0),"
"0","             X  = X_1 - X_0)"
"0","    "
"0","  } else {"
"0","    "
"0","    villmean <-  aggregate(d[,c(""IDV"",y)], by= list(d$IDV), FUN=""mean"", na.rm=TRUE) %>%"
"0","      select(IDV, X = y)"
"0","    "
"0","  }"
"0","  with(villmean,"
"0","       c( N = sum(!is.na(X)), mean = mean(X, na.rm = T), sd = sd(X, na.rm = T) , min = min(X, na.rm = T), max =max(X, na.rm = T)))"
"0","},y = outcomes, datasets)"
"0",""
"0","kable(t(sumStats ), digits = 2 )"
